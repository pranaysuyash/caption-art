# Requirements Document

## Introduction

This document outlines the requirements for the AI Caption Generation System, which uses BLIP image captioning and LLM-powered rewrites to generate contextually relevant and stylistically diverse caption suggestions for uploaded images.

## Glossary

- **AI Caption Generation System**: The service that generates caption suggestions using computer vision and language models
- **BLIP Model**: Bootstrapping Language-Image Pre-training model for generating base image descriptions
- **LLM Rewrite**: Large Language Model transformation of base captions into stylistically varied alternatives
- **Caption Style**: A category of caption tone/personality (creative, funny, poetic, minimal, dramatic, quirky)
- **Base Caption**: The initial image description generated by the BLIP model
- **Caption Variant**: A stylistically rewritten version of the base caption
- **Replicate API**: The cloud service providing access to the BLIP model
- **OpenAI API**: The service providing LLM capabilities for caption rewrites

## Requirements

### Requirement 1

**User Story:** As a user, I want automatic caption suggestions when I upload an image, so that I can quickly find appropriate text for my caption art.

#### Acceptance Criteria

1. WHEN a user uploads an image THEN the AI Caption Generation System SHALL call the Replicate API with the image data
2. WHEN the Replicate API responds THEN the AI Caption Generation System SHALL extract the base caption from the response
3. WHEN the base caption is received THEN the AI Caption Generation System SHALL pass it to the OpenAI API for rewrites
4. WHEN the OpenAI API responds THEN the AI Caption Generation System SHALL parse and return 3-5 caption variants
5. WHEN caption generation completes THEN the AI Caption Generation System SHALL display all variants to the user

### Requirement 2

**User Story:** As a user, I want captions in different styles, so that I can choose one that matches the mood of my image.

#### Acceptance Criteria

1. WHEN requesting caption rewrites THEN the AI Caption Generation System SHALL generate creative style variants with imaginative and artistic language
2. WHEN requesting caption rewrites THEN the AI Caption Generation System SHALL generate funny style variants with humorous and playful tone
3. WHEN requesting caption rewrites THEN the AI Caption Generation System SHALL generate poetic style variants with lyrical and metaphorical language
4. WHEN requesting caption rewrites THEN the AI Caption Generation System SHALL generate minimal style variants with concise and impactful phrasing
5. WHEN requesting caption rewrites THEN the AI Caption Generation System SHALL generate dramatic style variants with intense and emotional language

### Requirement 3

**User Story:** As a user, I want caption generation to be fast, so that I don't have to wait long after uploading an image.

#### Acceptance Criteria

1. WHEN calling the Replicate API THEN the AI Caption Generation System SHALL set a timeout of 30 seconds
2. WHEN calling the OpenAI API THEN the AI Caption Generation System SHALL set a timeout of 15 seconds
3. WHEN both API calls complete THEN the AI Caption Generation System SHALL return results within 45 seconds total
4. WHEN an API call times out THEN the AI Caption Generation System SHALL return a timeout error to the user
5. WHEN network latency is high THEN the AI Caption Generation System SHALL display a loading indicator with progress feedback

### Requirement 4

**User Story:** As a user, I want meaningful error messages, so that I understand what went wrong if caption generation fails.

#### Acceptance Criteria

1. WHEN the Replicate API returns an error THEN the AI Caption Generation System SHALL display a user-friendly error message
2. WHEN the OpenAI API returns an error THEN the AI Caption Generation System SHALL display a user-friendly error message
3. WHEN API rate limits are exceeded THEN the AI Caption Generation System SHALL inform the user to try again later
4. WHEN the image format is unsupported THEN the AI Caption Generation System SHALL inform the user of supported formats
5. WHEN network connectivity fails THEN the AI Caption Generation System SHALL display a connection error message

### Requirement 5

**User Story:** As a user, I want to see which caption is the base description, so that I can understand the AI's interpretation of my image.

#### Acceptance Criteria

1. WHEN displaying caption variants THEN the AI Caption Generation System SHALL label the base caption as "Original Description"
2. WHEN displaying caption variants THEN the AI Caption Generation System SHALL label each rewrite with its style category
3. WHEN captions are displayed THEN the AI Caption Generation System SHALL show the base caption first in the list
4. WHEN a user hovers over a caption THEN the AI Caption Generation System SHALL highlight the caption card
5. WHEN captions are loading THEN the AI Caption Generation System SHALL display skeleton placeholders for each expected variant

### Requirement 6

**User Story:** As a user, I want to regenerate captions, so that I can get fresh suggestions if I don't like the initial ones.

#### Acceptance Criteria

1. WHEN a user clicks the regenerate button THEN the AI Caption Generation System SHALL call the caption generation APIs again
2. WHEN regenerating THEN the AI Caption Generation System SHALL use the same image data as the original request
3. WHEN regenerating THEN the AI Caption Generation System SHALL clear previous caption suggestions
4. WHEN regeneration completes THEN the AI Caption Generation System SHALL display the new caption variants
5. WHEN regeneration is in progress THEN the AI Caption Generation System SHALL disable the regenerate button to prevent duplicate requests

### Requirement 7

**User Story:** As a user, I want captions that are contextually relevant, so that they accurately describe what's in my image.

#### Acceptance Criteria

1. WHEN the BLIP model analyzes an image THEN the AI Caption Generation System SHALL receive a description of visible objects and scenes
2. WHEN the LLM rewrites captions THEN the AI Caption Generation System SHALL preserve the core subject matter from the base caption
3. WHEN generating variants THEN the AI Caption Generation System SHALL maintain factual accuracy about image content
4. WHEN the image contains people THEN the AI Caption Generation System SHALL describe actions and settings without identifying individuals
5. WHEN the image contains text THEN the AI Caption Generation System SHALL focus on visual elements rather than reading embedded text

### Requirement 8

**User Story:** As a user, I want appropriate caption length, so that text fits well in my caption art composition.

#### Acceptance Criteria

1. WHEN generating caption variants THEN the AI Caption Generation System SHALL limit each caption to 100 characters maximum
2. WHEN the base caption exceeds 100 characters THEN the AI Caption Generation System SHALL instruct the LLM to create shorter variants
3. WHEN captions are too short THEN the AI Caption Generation System SHALL ensure a minimum of 10 characters for meaningful content
4. WHEN displaying captions THEN the AI Caption Generation System SHALL show character count for each variant
5. WHEN a user selects a caption THEN the AI Caption Generation System SHALL allow manual editing to adjust length
